# T2.1.3 Sensorless Tension Observer

**Component:** Virtual Tension Sensor (V=0 capable)
**Date:** 2026-02-18
**Inventor:** Jaouher ROMDHANE
**Status:** Phase 2 Implementation

---

## 1. Purpose

Estimate web tension without relying on a load cell, especially at zero or near-zero speed. The observer blends a torque-balance estimate with a web-span model to remain stable across all operating regimes.

---

## 2. Model Summary

### 2.1 Torque Balance (low speed / V=0)

$$
\tau_{\text{motor}} = J \cdot \alpha + \tau_{\text{friction}} + T \cdot R
$$

Solve for tension:

$$
\hat{T}_{\tau} = \frac{\tau_{\text{motor}} - J\alpha - \hat{\tau}_{\text{friction}}}{R}
$$

### 2.2 Web Span Dynamics (mid/high speed)

Span strain dynamics:

$$
\frac{d\epsilon}{dt} = \frac{v_2 - v_1}{L} + \frac{v_1}{L}(\epsilon_{\text{in}} - \epsilon)
$$

Tension from material model:

$$
\hat{T}_{\text{span}} = f(\epsilon, \dot{\epsilon})
$$

---

## 3. Fusion Strategy

Blend torque-based and span-based estimates using a speed-dependent weight:

$$
\hat{T} = (1-w)\,\hat{T}_{\tau} + w\,\hat{T}_{\text{span}}
$$

Weight definition:

$$
w = \text{clamp}\left(\frac{|\omega| - \omega_{min}}{\omega_{max} - \omega_{min}}, 0, 1\right)
$$

- $|\omega| \le \omega_{min}$: torque-based mode
- $|\omega| \ge \omega_{max}$: span-based mode
- transition: smooth fusion

---

## 4. Filtering and Safety

- Exponential smoothing (EMA) on output tension
- Clamping to physical bounds $[T_{min}, T_{max}]$
- Optional replacement with measured tension at high speed

---

## 5. Implementation

**File:** `src/prowinder/control/tension_observer.py`

### Main API

```python
estimate = observer.update(
    tau_motor,
    omega,
    alpha,
    R,
    v_upstream,
    v_downstream,
    J_total=None,
    strain_upstream=0.0,
    tension_measured=None,
)
```

### Output

```python
TensionEstimate(
    tension,        # fused output
    tension_tau,    # torque-based
    tension_span,   # span-based
    mode,           # torque / fusion / span
    confidence,
    weight,
    friction_est,
    timestamp
)
```

---

## 6. Integration in Digital Twin

**File:** `src/prowinder/simulation/digital_twin.py`

- Observer used in CLOSED_LOOP_TENSION mode
- Torque-based estimate dominates at low speed
- Span model (or measured tension) dominates at high speed

---

## 7. Validation

**Unit tests:** `tests/test_tension_observer.py`

Covered scenarios:
- Zero speed torque-based estimation
- Mid-speed blending
- High-speed span dominance
- Zero speed with non-zero friction estimate

**Validation script:** `scripts/validation/validate_T2.1.3.py`

---

## 8. Parameters (defaults)

| Parameter | Default | Notes |
|----------|---------|-------|
| $\omega_{min}$ | 1.0 rad/s | start blending |
| $\omega_{max}$ | 5.0 rad/s | full span dominance |
| EMA alpha | 0.15 | output smoothing |
| $T_{max}$ | 2000 N | clamp |

---

## 9. Limitations

- Requires reasonable torque measurement or torque command model
- Accuracy depends on friction observer quality
- Span model assumes known material properties

---

## 10. References

- `docs/patents/Patent_1_TensionVirtualSensor.md`
- `src/prowinder/control/observers.py`
- `src/prowinder/mechanics/web_span.py`
